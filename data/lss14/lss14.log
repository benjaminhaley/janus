!lss14.scr@
new size 8000000 @

names city sex gd3 ahs agexcat agecat ctime dosecat subjects pyr agex age  
colon10 stomach10 bladder10 liver10 pancreas10 lung10 breast10 uterus10 ovary10 marrow10 
death solid esoph stomach colon rectum liver gallbldr pancre othdig lung breast uterus ovary prostate bladder
kidney othuri othsolid leukemia lymphoma myeloma blooddis cvd respiratory digestive genitourinary inf external  @

skip 1@
input lss14.csv @

Input from lss14.csv

       53783 records read       53782 records used
                                    1 records rejected

53 variables defined  At least 500 additional variables can be created.

show@

The current variables are:
city          sex           gd3           ahs           agexcat       
agecat        ctime         dosecat       subjects      pyr           
agex          age           colon10       stomach10     bladder10     
liver10       pancreas10    lung10        breast10      uterus10      
ovary10       marrow10      death         solid         esoph         
stomach       colon         rectum        liver         gallbldr      
pancre        othdig        lung          breast        uterus        
ovary         prostate      bladder       kidney        othuri        
othsolid      leukemia      lymphoma      myeloma       blooddis      
cvd           respiratory   digestive     genitourinary inf           
external      %ORD          %SEL          
53 variables used.   At least 500 additional variables can be created.

The current constants are:
%MV 
1 constants used


level city sex agexcat agecat@

city has 2 levels from 1 to 2
sex has 2 levels from 1 to 2
agexcat has 15 levels from 1 to 15
agecat has 20 levels from 2 to 21

tran py1 = pyr/10000;
colon10 = colon10/1000; d2=1.12*colon10*colon10; pygy = py1*colon10;
ew30=(agex-30)/10; ew30sq = ew30*ew30;
e30sp = ew30* (agex > 30); e30qsp = e30sp*e30sp; 
e50sp = ((agex - 50)/10)* (agex > 50); e50qsp = e50sp*e50sp; 
lage70=log(age/70); lage70sq = lage70^2;
lage70qsp = (age >= 70)* lage70sq; lage40qsp = (age >= 40)* log(age/40)^2;
msex = 2*sex - 3;female = sex == 2@

! define colon dose categories for table 1
categ  colon10 as fdosecat < /0.005 /0.1 /0.2 /0.5 /1.0 /2.0  >@
fdosecat has 7 levels from 1 to 7
! define age at exposure categories for table 2
categ  agex as fagexcat < /10 /20 /30 /40 /50  >@
fagexcat has 6 levels from 1 to 6

!Number of subjects by colon dose category, city, and sex (Table 1)
sum subjects@

           Summary for subjects

                Sum         Count      Minimum      Maximum
              86611         53782            0          769

sum subjects ; by fdosecat @

           Summary for subjects

fdosecat           Sum         Count      Minimum      Maximum
    1         38509          7551            0          769
    2         29961         11953            0          733
    3          5974          8538            0           98
    4          6356          7988            0          142
    5          3424          6294            0           63
    6          1763          7888            0           32
    7           624          3570            0           25

sum subjects ; by city @

           Summary for subjects

 city           Sum         Count      Minimum      Maximum
    1         58494         30379            0          769
    2         28117         23403            0          540

sum subjects ; by sex @

           Summary for subjects

  sex           Sum         Count      Minimum      Maximum
    1         35687         25068            0          726
    2         50924         28714            0          769


!Number of deaths by age at exposure (Table 2)
sum death@

           Summary for death

                Sum         Count      Minimum      Maximum
              50620         53782            0           80

sum death; by fagexcat @

           Summary for death

fagexcat           Sum         Count      Minimum      Maximum
    1          2200         10725            0           19
    2          4887         11034            0           29
    3          5178          9295            0           33
    4         10410          8704            0           80
    5         13397          7111            0           56
    6         14548          6913            0           44


!Test and estimation of ERR for all causes  by sex  (Table 3)
strata city sex agexcat agecat@

The current model has 1200 strata

pyr py1@
case death@
! For males
select sex eq 1@
25068 records to be used

sum death@

Using sex eq 1

           Summary for death

                Sum         Count      Minimum      Maximum
              22302         25068            0           46

fit@
          Iter  Step      Deviance

             0     0    16194.363
             1     0    16194.363

Piece-wise exponential regression
Product additive excess model { T0 * ( 1 + T1 + T2 + ...) }
Stratification on city sex agexcat agecat with 315 strata

Using sex eq 1

    death is used for cases
      py1 is used for person years


            Records used        25068

                Deviance    16194.363
            Pearson Chi2    58431.055      Degrees of freedom   24753


null@line 1 colon10@fit@
          Iter  Step      Deviance

             0     0    16194.363
             1     0    16149.750
             2     0    16149.738
             3     0    16149.738

Piece-wise exponential regression
Product additive excess model { T0 * ( 1 + T1 + T2 + ...) }
Stratification on city sex agexcat agecat with 315 strata

Using sex eq 1

    death is used for cases
      py1 is used for person years


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Linear term 1
 2 colon10..................         0.1500     0.02477      6.056    < 0.001

            Records used        25068

                Deviance    16149.738
            Pearson Chi2    53353.709      Degrees of freedom   24752


lrt@

             LR statistic       44.63      Degrees of freedom      1
                  P value     < 0.001

bound 2@
      Profile likelihood bounds for parameter 2 (colon10)

                  MLE       0.15

               97.5% lower bound      0.1035
               97.5% upper bound      0.1986

line 1@
!For female
select sex eq 2@
28714 records to be used

sum death@

Using sex eq 2

           Summary for death

                Sum         Count      Minimum      Maximum
              28318         28714            0           80

fit@
          Iter  Step      Deviance

             0     0    16929.661
             1     0    16929.661

Piece-wise exponential regression
Product additive excess model { T0 * ( 1 + T1 + T2 + ...) }
Stratification on city sex agexcat agecat with 316 strata

Using sex eq 2

    death is used for cases
      py1 is used for person years


            Records used        28714

                Deviance    16929.661
            Pearson Chi2    70764.477      Degrees of freedom   28398


null@line 1 colon10@fit@
          Iter  Step      Deviance

             0     0    16929.661
             1     0    16785.579
             2     0    16785.577
             3     0    16785.577

Piece-wise exponential regression
Product additive excess model { T0 * ( 1 + T1 + T2 + ...) }
Stratification on city sex agexcat agecat with 316 strata

Using sex eq 2

    death is used for cases
      py1 is used for person years


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Linear term 1
 2 colon10..................         0.2978     0.02846      10.46    < 0.001

            Records used        28714

                Deviance    16785.577
            Pearson Chi2     59765.95      Degrees of freedom   28397


lrt@

             LR statistic       144.1      Degrees of freedom      1
                  P value     < 0.001

bound 2@
      Profile likelihood bounds for parameter 2 (colon10)

                  MLE     0.2978

               97.5% lower bound      0.2438
               97.5% upper bound      0.3539

line 1@

!ERR and effect modifications for solid cancer (Table 4)
noselect@

53782 records to be used

case solid@
line 1 colon10@
logl 1 ew30 lage70@
pline 1 %con = 1 msex@fit@

          Iter  Step      Deviance

             0     0    18517.002
             1     0    18354.881
             2     0    18303.055
             3     0    18299.260
             4     0    18299.013
             5     0    18298.997
             6     0    18298.995
             7     0    18298.995

Piece-wise exponential regression
Product additive excess model { T0 * ( 1 + T1 + T2 + ...) }
Stratification on city sex agexcat agecat with 631 strata

    solid is used for cases
      py1 is used for person years


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Linear term 1
 2 colon10..................         0.4227     0.05032      8.399    < 0.001

Log-linear term 1
 3 ew30.....................        -0.3459     0.08136     -4.252    < 0.001
 4 lage70...................        -0.8574      0.4232     -2.026     0.0428

Linear product term 1
 5 %CON.....................          1.000     Aliased
 6 msex.....................         0.3441     0.08783      3.917    < 0.001

            Records used        53782

                Deviance    18298.995
            Pearson Chi2    84288.859      Degrees of freedom   53147


bound 2@
      Profile likelihood bounds for parameter 2 (colon10)

                  MLE     0.4227

               97.5% lower bound       0.322
               97.5% upper bound      0.5252

bound 3@
      Profile likelihood bounds for parameter 3 (ew30)

                  MLE    -0.3459    exp(MLE)     0.7076

               97.5% lower bound     -0.5252
                       exp(bound)     0.5914
               97.5% upper bound     -0.1908
                       exp(bound)     0.8263

bound 4@

      Profile likelihood bounds for parameter 4 (lage70)

                  MLE    -0.8574    exp(MLE)     0.4243

               97.5% lower bound      -1.602
                       exp(bound)     0.2014
               97.5% upper bound    -0.06305
                       exp(bound)     0.9389


!EAR and effect modifications for solid cancer (Table 5)
nostrata@
Model has no strata
add@
logl 0 sex*city:-5 sex*ew30 sex*ew30sq sex*e30qsp sex*e50qsp 
     sex*lage70 sex*lage70sq sex*lage40qsp sex*lage70qsp
     ew30*lage70 -%con@ 
line 1 colon10@
logl 1 ew30 lage70@
pline 1 %con = 1 msex@fit@

          Iter  Step      Deviance

             0     0   197995.121
             1     4   180367.753
             2     4   174113.578
             3     3    40272.885
             4     2    33196.400
             5     1    21361.188
             6     2    21225.447
             7     2    21080.214
             8     2    20945.167
             9     1    20094.518
            10     0    19111.811
            11     0    18998.332
            12     0    18975.035
            13     0    18969.164
            14     0    18967.600
            15     0    18967.537
            16     0    18967.537
            17     0    18967.537

Piece-wise exponential regression
Additive model { T0 + T1 + T2 + ... }

    solid is used for cases
      py1 is used for person years


                            Parameter Summary Table

 # Name                            Estimate     Std.Err.  Test Stat.  P value
-- ----------------------------   ----------   ---------  ----------  --------
Log-linear term 0
 1 sex_1 * city_1...........          5.531      0.7987      6.925    < 0.001
 2 sex_1 * city_2...........          5.537      0.7989       6.93    < 0.001
 3 sex_2 * city_1...........          1.967      0.7433      2.647    0.00813
 4 sex_2 * city_2...........          2.030      0.7435      2.731    0.00632
 5 ew30 * lage70............       -0.02180     0.07059    -0.3088      > 0.5
 6 sex_1 * ew30.............       -0.08612     0.03841     -2.242      0.025
 7 sex_2 * ew30.............         0.1925     0.03792      5.078    < 0.001
 8 sex_1 * ew30sq...........       -0.06323     0.02157     -2.931    0.00338
 9 sex_2 * ew30sq...........       0.005572     0.02263     0.2462      > 0.5
10 sex_1 * e30qsp...........        0.08884     0.03786      2.346      0.019
11 sex_2 * e30qsp...........       -0.05754     0.03783     -1.521      0.128
12 sex_1 * e50qsp...........        -0.1963     0.05912     -3.321    < 0.001
13 sex_2 * e50qsp...........       -0.07116     0.05564     -1.279      0.201
14 sex_1 * lage70...........          7.889       2.735      2.885    0.00391
15 sex_2 * lage70...........         -2.584        2.54     -1.017      0.309
16 sex_1 * lage70sq.........          1.249       2.179     0.5732      > 0.5
17 sex_2 * lage70sq.........         -4.664       2.045     -2.281     0.0226
18 sex_1 * lage40qsp........         -2.448       2.543    -0.9627      0.336
19 sex_2 * lage40qsp........          6.003       2.363       2.54     0.0111
20 sex_1 * lage70qsp........         -5.624       1.898     -2.963    0.00305
21 sex_2 * lage70qsp........         -1.540       1.519     -1.014      0.311

Linear term 1
22 colon10..................          26.40       3.142        8.4    < 0.001

Log-linear term 1
23 ew30.....................        -0.2135     0.07157     -2.983    0.00286
24 lage70...................          3.384      0.3659       9.25    < 0.001

Linear product term 1
25 %CON.....................          1.000     Aliased
26 msex.....................        0.06769     0.09649     0.7015      0.483

            Records used        53782

                Deviance    18967.537
            Pearson Chi2    94986.746      Degrees of freedom   53757


bound 22@
      Profile likelihood bounds for parameter 22 (colon10)

                  MLE       26.4

               97.5% lower bound        20.3
               97.5% upper bound       32.77

bound 23@
      Profile likelihood bounds for parameter 23 (ew30)

                  MLE    -0.2135    exp(MLE)     0.8078

               97.5% lower bound     -0.3679
                       exp(bound)     0.6922
               97.5% upper bound    -0.07641
                       exp(bound)     0.9264

bound 24@

      Profile likelihood bounds for parameter 24 (lage70)

                  MLE      3.384    exp(MLE)       29.5

               97.5% lower bound       2.746
                       exp(bound)      15.59
               97.5% upper bound       4.083
                       exp(bound)      59.33

stop@
